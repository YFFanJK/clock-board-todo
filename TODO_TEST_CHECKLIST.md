# TODO 功能测试清单

本文档用于验证最新版本的 TODO 功能实现是否正确。

## 前置条件

- [ ] 已安装依赖：`pnpm install` 或 `npm install`
- [ ] Socket.IO 服务端正在运行：`npm run start-server`
- [ ] 前端开发服务器正在运行：`pnpm dev`
- [ ] 至少有两台设备（或浏览器标签页）可访问：展板端和派发端

---

## 测试场景

### 1️⃣ 创建任务测试

**步骤：**
1. 打开派发端：`http://192.168.x.x:5173/?mode=edit`
2. 填写完整的任务表单：
   - 任务名称：`Test Task 1`
   - 简介：`This is a test task`
   - 截止日期：选择明天的日期
   - 标签：添加 `测试` 和 `重要`
3. 点击 **发送任务** 按钮

**预期结果：**
- [ ] 任务立即出现在派发端的任务列表中（表单下方）
- [ ] 表单字段清空，焦点回到任务名称输入框
- [ ] 任务同时出现在展板端（需向右滑动到第四页）
- [ ] 任务数据完整（名称、简介、截止日期、标签都显示）

---

### 2️⃣ 标记完成测试

**步骤 A（展板端完成）：**
1. 在展板端的 TODO 页面找到上面创建的任务
2. 点击任务右上角的 **☑️ 复选框**

**步骤 B（派发端完成）：**
1. 在派发端的任务列表中找到同一任务
2. 点击任务左侧的 **☑️ 复选框**

**预期结果：**
- [ ] 点击后，复选框变为勾选状态 ✓
- [ ] 任务名称显示删除线（text-decoration: line-through）
- [ ] 任务整体透明度降低，呈现灰色系
- [ ] 任务自动排序到列表下方（未完成任务在上）
- [ ] 无论在展板端还是派发端完成，两端都实时同步

---

### 3️⃣ 删除任务测试

**步骤 A（展板端删除）：**
1. 在展板端任务卡片上悬停鼠标
2. 右上角会显示 **🗑️ 删除按钮**（之前可能被 ☑️ 掩盖）
3. 点击删除按钮
4. 确认删除提示

**步骤 B（派发端删除）：**
1. 在派发端任务列表中的某个任务上悬停鼠标
2. 右侧会显示 **🗑️ 删除按钮**
3. 点击删除按钮
4. 确认删除提示

**预期结果：**
- [ ] 点击删除后出现确认对话框（"确认删除此任务？"）
- [ ] 确认后，任务从列表中彻底移除
- [ ] 删除操作在所有设备上同时生效（展板端、派发端同时刷新）
- [ ] 已完成的任务和未完成的任务都可以删除

---

### 4️⃣ 截止日期颜色编码测试

**步骤：**
1. 创建多个任务，截止日期分别为：
   - 已过期（如昨天）
   - 今天
   - 明天
   - 3 天后
   - 一周后

**预期结果：**
- [ ] **已过期**：🔴 红色 (`bg-red-600`)
- [ ] **今天**：🟠 橙色 (`bg-orange-600`)
- [ ] **1~3 天内**：🟡 黄色 (`bg-yellow-600`)
- [ ] **3 天后**：🟢 绿色 (`bg-emerald-600`)

---

### 5️⃣ 实时同步测试

**步骤：**
1. 同时打开两个浏览器窗口（或标签页）：
   - 一个展板端：`http://192.168.x.x:5173/`
   - 一个派发端：`http://192.168.x.x:5173/?mode=edit`
2. 在派发端创建一个新任务
3. 观察展板端是否实时刷新

**预期结果：**
- [ ] 派发端创建任务后，展板端无需刷新，任务自动出现
- [ ] 派发端完成任务，展板端立即显示删除线和灰色样式
- [ ] 派发端删除任务，展板端立即移除该任务
- [ ] 展板端完成/删除任务，派发端列表也同步更新

---

### 6️⃣ 跨设备同步测试

**前置：** 至少两台不同的设备或 IP 地址

**步骤：**
1. 设备 A（手机）：访问 `http://平板IP:5173/?mode=edit`，创建任务
2. 设备 B（平板）：访问 `http://平板IP:5173/`，进入 TODO 页面

**预期结果：**
- [ ] 设备 A 创建的任务在设备 B 上实时显示
- [ ] 设备 B 完成任务，设备 A 的列表也同时更新
- [ ] 不需要刷新页面，所有操作都是实时同步的

---

### 7️⃣ UI 交互细节测试

**展板端卡片 UI：**
- [ ] 未完成的任务显示蓝色渐变背景
- [ ] 已完成的任务显示灰色背景，透明度降低
- [ ] 任务名称醒目显示（XL 字号，加粗）
- [ ] 简介文本最多显示 2 行，超出部分截断
- [ ] 标签显示为"胶囊"形式（圆角容器）
- [ ] 删除按钮仅在鼠标悬停时出现（opacity-0 → opacity-100）
- [ ] 网格布局在宽屏上显示 2 列，在手机上显示 1 列

**派发端表单 UI：**
- [ ] 任务名称输入框：支持 Enter 键提交
- [ ] 简介输入框：多行文本，可调整文本高度
- [ ] 截止日期：使用原生 HTML5 日期选择器
- [ ] 标签输入：支持 Enter 键添加，点击 ✕ 移除
- [ ] 发送按钮：全宽显示，点击后清空所有字段
- [ ] 任务列表：显示完整任务信息，与展板端保持一致

---

### 8️⃣ 边界情况测试

**测试场景：**

1. **空任务名称：**
   - [ ] 不填写任务名称直接点击发送，应该不会添加任务

2. **特殊字符：**
   - [ ] 创建名称包含 emoji、中文、特殊符号的任务
   - [ ] 预期：任务正常创建，显示正确

3. **长文本：**
   - [ ] 创建超长名称、超长简介的任务
   - [ ] 预期：名称换行显示，简介截断到 2 行

4. **多个标签：**
   - [ ] 添加 10 个以上标签
   - [ ] 预期：所有标签都显示，可以灵活换行

5. **快速操作：**
   - [ ] 快速连续创建多个任务
   - [ ] 预期：所有任务都创建成功，顺序正确（最新的在前）

6. **网络延迟模拟：**
   - [ ] 打开浏览器开发者工具，Throttle 网络速度
   - [ ] 创建/删除任务观察同步延迟
   - [ ] 预期：即使有延迟，最终也会同步成功

---

## 常见问题排查

| 问题 | 排查步骤 |
|------|--------|
| 派发端创建的任务未出现在展板端 | 1. 检查展板端是否已打开到 TODO 页面（向右滑动到第四页）<br/>2. 检查浏览器控制台是否有错误<br/>3. 检查 Socket.IO 服务端是否正在运行 |
| 删除按钮不显示 | 1. 确保鼠标悬停在任务卡片/列表项上<br/>2. 检查浏览器是否缩放，调整到 100%<br/>3. 尝试刷新页面 |
| 任务数据丢失（刷新或重启后） | 这是正常现象。当前实现使用内存存储，重启服务端后任务会丢失。如需持久化，需要集成数据库。 |
| 跨设备不同步 | 1. 检查两设备是否在同一局域网<br/>2. 检查防火墙是否开放 3001 端口<br/>3. 检查 `src/stores/todos.ts` 中的 `serverUrl` 是否指向正确的服务器 |

---

## 测试完成检查清单

- [ ] 创建任务功能正常
- [ ] 标记完成功能正常，UI 样式符合预期
- [ ] 删除任务功能正常，删除确认对话框工作
- [ ] 截止日期颜色编码正确
- [ ] 派发端和展板端实时同步
- [ ] 跨设备同步正常
- [ ] UI 交互细节符合设计
- [ ] 边界情况处理正常
- [ ] 没有控制台错误输出

---

## 性能测试

**（可选）如果需要测试大数据量：**

```javascript
// 在浏览器控制台中执行，快速创建 100 个任务
for (let i = 0; i < 100; i++) {
  const task = {
    id: Date.now() + i,
    name: `Task ${i}`,
    description: `Description ${i}`,
    deadline: new Date(Date.now() + Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
    tags: ['tag1', 'tag2'],
    completed: Math.random() > 0.5,
    createdAt: Date.now()
  };
  // 通过 pinia store 添加任务
  // 或直接修改任务数组进行测试
}
```

**预期结果：**
- [ ] 即使有 100+ 任务，列表仍可流畅滚动
- [ ] 新建、删除任务时没有明显卡顿
- [ ] 内存使用在合理范围内

---

## 记录测试结果

请在测试完成后记录：

- **测试日期**：____________________
- **测试人员**：____________________
- **测试环境**：____________________
- **发现的 Bug**：

```
1. ...
2. ...
```

- **改进建议**：

```
1. ...
2. ...
```

---

## 9️⃣ 数据持久化测试

**步骤：**
1. 创建几个任务（5 个左右）
2. 记录任务列表内容
3. 停止服务端：按 Ctrl+C 或杀死进程
4. 重新启动服务端：`npm run start-server`
5. 刷新前端页面，观察任务列表

**预期结果：**
- [ ] 服务端启动时输出"Loaded X tasks from database"
- [ ] 重启后任务列表完全恢复（同样的任务、同样的完成状态）
- [ ] 没有任务丢失
- [ ] 新建任务后再重启，新任务也会被保存
- [ ] `tasks.db` 文件存在且大小随数据增加而增大

---

如有问题或发现 Bug，请参考 [TODO_FEATURE_GUIDE.md](TODO_FEATURE_GUIDE.md) 中的 **常见问题** 部分，或查阅 [SQLite 持久化指南](SQLITE_PERSISTENCE_GUIDE.md)。
